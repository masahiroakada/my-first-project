<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÅÆ„Ç¢„Éó„É™</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
    }

    body {
      font-family: "Hiragino Kaku Gothic ProN", "Rounded Mplus 1c", sans-serif;
      overflow: hidden;
      min-height: 100vh;
      min-height: 100dvh;
      background: #fef3e2;
    }

    /* --- ÂÖ±ÈÄö --- */
    .screen {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      min-height: 100dvh;
      padding: 20px;
    }
    .screen.active { display: flex; }

    /* --- „Éõ„Éº„É†ÁîªÈù¢ --- */
    #home {
      background: linear-gradient(135deg, #ffecd2, #fcb69f);
    }

    .home-title {
      font-size: 1.8rem;
      color: #e44d7b;
      margin-bottom: 8px;
    }

    .home-name {
      font-size: 3rem;
      color: #ff6b9d;
      margin-bottom: 30px;
      animation: bounce 1.5s infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-12px); }
    }

    .menu {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      max-width: 340px;
      width: 100%;
    }

    .menu-btn {
      background: #fff;
      border: none;
      border-radius: 24px;
      padding: 24px 12px;
      font-size: 1rem;
      cursor: pointer;
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
      transition: transform 0.15s;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .menu-btn:active { transform: scale(0.92); }
    .menu-btn .icon { font-size: 3rem; }
    .menu-btn .label { color: #555; font-weight: 600; }

    /* --- Êàª„Çã„Éú„Çø„É≥ --- */
    .back-btn {
      position: fixed;
      top: 16px;
      left: 16px;
      z-index: 100;
      background: rgba(255,255,255,0.85);
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 2px 10px rgba(0,0,0,0.15);
      display: none;
    }
    .back-btn.show { display: block; }

    /* --- „Å©„ÅÜ„Å∂„Å§„Ç≤„Éº„É† --- */
    #animals {
      background: linear-gradient(135deg, #a8edea, #fed6e3);
    }

    .animals-title {
      font-size: 1.5rem;
      color: #4a6fa1;
      margin-bottom: 20px;
    }

    .animal-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 14px;
      max-width: 360px;
      width: 100%;
    }

    .animal-btn {
      background: #fff;
      border: none;
      border-radius: 20px;
      padding: 16px 8px;
      font-size: 3rem;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transition: transform 0.15s;
      position: relative;
    }

    .animal-btn:active { transform: scale(0.9); }

    .animal-btn .animal-name {
      display: block;
      font-size: 0.85rem;
      color: #888;
      margin-top: 4px;
    }

    .animal-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      background: #fff;
      border-radius: 30px;
      padding: 40px;
      text-align: center;
      z-index: 200;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .animal-popup.show { transform: translate(-50%, -50%) scale(1); }
    .animal-popup .big-emoji { font-size: 6rem; }
    .animal-popup .sound-text {
      font-size: 2rem;
      color: #e44d7b;
      margin-top: 10px;
      font-weight: 700;
    }

    /* --- „ÅÑ„Çç„ÅÇ„Åù„Å≥ --- */
    #colors {
      background: linear-gradient(135deg, #fbc2eb, #a6c1ee);
    }

    .colors-title {
      font-size: 1.5rem;
      color: #7b5ea7;
      margin-bottom: 10px;
    }

    .color-question {
      font-size: 1.3rem;
      color: #555;
      margin-bottom: 20px;
    }

    .color-target {
      font-size: 1.6rem;
      font-weight: 700;
    }

    .color-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 14px;
      max-width: 320px;
      width: 100%;
    }

    .color-btn {
      width: 90px;
      height: 90px;
      border: 4px solid #fff;
      border-radius: 50%;
      cursor: pointer;
      transition: transform 0.15s;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      justify-self: center;
    }
    .color-btn:active { transform: scale(0.9); }

    .color-result {
      margin-top: 20px;
      font-size: 2.5rem;
      min-height: 3rem;
    }

    .color-score {
      margin-top: 10px;
      font-size: 1.2rem;
      color: #7b5ea7;
    }

    /* --- „Åµ„ÅÜ„Åõ„Çì„Ç≤„Éº„É† --- */
    #balloons {
      background: linear-gradient(180deg, #87ceeb, #e0f7ff);
      position: relative;
      overflow: hidden;
    }

    .balloon-score {
      position: fixed;
      top: 16px;
      right: 16px;
      background: rgba(255,255,255,0.85);
      border-radius: 16px;
      padding: 8px 16px;
      font-size: 1.2rem;
      font-weight: 700;
      color: #e44d7b;
      z-index: 100;
    }

    .balloon {
      position: absolute;
      font-size: 3.5rem;
      cursor: pointer;
      animation: floatUp linear forwards;
      filter: drop-shadow(0 4px 6px rgba(0,0,0,0.15));
      transition: transform 0.1s;
    }
    .balloon:active { transform: scale(1.3); }

    @keyframes floatUp {
      from { transform: translateY(0); opacity: 1; }
      to { transform: translateY(-110vh); opacity: 1; }
    }

    .pop-effect {
      position: absolute;
      font-size: 2rem;
      pointer-events: none;
      animation: popAnim 0.6s forwards;
    }

    @keyframes popAnim {
      0% { transform: scale(0.5); opacity: 1; }
      100% { transform: scale(2); opacity: 0; }
    }

    /* --- „Åä„Åà„Åã„Åç --- */
    #drawing {
      background: #fff;
      padding: 0;
    }

    .draw-toolbar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #fff;
      padding: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
      z-index: 100;
      flex-wrap: wrap;
    }

    .draw-color {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 3px solid #ddd;
      cursor: pointer;
    }
    .draw-color.active { border-color: #333; box-shadow: 0 0 0 2px #333; }

    .draw-clear {
      background: #ff6b6b;
      color: #fff;
      border: none;
      border-radius: 12px;
      padding: 10px 16px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
    }

    canvas {
      display: block;
      touch-action: none;
    }

    /* --- Êòü„Ç®„Éï„Çß„ÇØ„Éà --- */
    .star-burst {
      position: fixed;
      pointer-events: none;
      z-index: 300;
      font-size: 1.5rem;
      animation: starPop 0.8s forwards;
    }

    @keyframes starPop {
      0% { transform: scale(0) rotate(0deg); opacity: 1; }
      50% { transform: scale(1.5) rotate(180deg); opacity: 1; }
      100% { transform: scale(0.5) rotate(360deg) translateY(-60px); opacity: 0; }
    }
  </style>
</head>
<body>

  <button class="back-btn" id="backBtn" onclick="goHome()">üè†</button>

  <!-- „Éõ„Éº„É†ÁîªÈù¢ -->
  <div class="screen active" id="home">
    <div class="home-title">„Çà„ÅÜ„Åì„ÅùÔºÅ</div>
    <div class="home-name" onclick="speak('„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ„Åì„Çì„Å´„Å°„ÅØÔºÅ„Åç„Çá„ÅÜ„ÇÇ„ÅÑ„Å£„Åó„Çá„Å´„ÅÇ„Åù„Åº„ÅÜ„Å≠ÔºÅ', 1.4, 0.9)">üåü „Åä„Å®„Åã„Å°„ÇÉ„Çì üåü</div>
    <div class="menu">
      <button class="menu-btn" onclick="goScreen('animals')">
        <span class="icon">üêæ</span>
        <span class="label">„Å©„ÅÜ„Å∂„Å§</span>
      </button>
      <button class="menu-btn" onclick="goScreen('colors')">
        <span class="icon">üé®</span>
        <span class="label">„ÅÑ„Çç„ÅÇ„Åù„Å≥</span>
      </button>
      <button class="menu-btn" onclick="goScreen('balloons')">
        <span class="icon">üéà</span>
        <span class="label">„Åµ„ÅÜ„Åõ„Çì</span>
      </button>
      <button class="menu-btn" onclick="goScreen('drawing')">
        <span class="icon">‚úèÔ∏è</span>
        <span class="label">„Åä„Åà„Åã„Åç</span>
      </button>
    </div>
  </div>

  <!-- „Å©„ÅÜ„Å∂„Å§ -->
  <div class="screen" id="animals">
    <div class="animals-title">„Å©„ÅÜ„Å∂„Å§„Çí„Çø„ÉÉ„Éó„Åó„Å¶„Å≠ÔºÅ</div>
    <div class="animal-grid" id="animalGrid"></div>
    <div class="animal-popup" id="animalPopup">
      <div class="big-emoji" id="popupEmoji"></div>
      <div class="sound-text" id="popupSound"></div>
    </div>
  </div>

  <!-- „ÅÑ„Çç„ÅÇ„Åù„Å≥ -->
  <div class="screen" id="colors">
    <div class="colors-title">„ÅÑ„Çç„ÅÇ„Åù„Å≥</div>
    <div class="color-question">
      <span class="color-target" id="colorTarget"></span><br>„ÅØ„Å©„Çå„Åã„Å™Ôºü
    </div>
    <div class="color-grid" id="colorGrid"></div>
    <div class="color-result" id="colorResult"></div>
    <div class="color-score" id="colorScore"></div>
  </div>

  <!-- „Åµ„ÅÜ„Åõ„Çì -->
  <div class="screen" id="balloons">
    <div class="balloon-score">‚≠ê <span id="balloonScore">0</span></div>
  </div>

  <!-- „Åä„Åà„Åã„Åç -->
  <div class="screen" id="drawing">
    <canvas id="drawCanvas"></canvas>
    <div class="draw-toolbar" id="drawToolbar"></div>
  </div>

  <script>
    /* ===== ÁîªÈù¢Âàá„ÇäÊõø„Åà ===== */
    let currentScreen = 'home';
    let balloonInterval = null;

    /* ===== Èü≥Â£∞„Éò„É´„Éë„Éº ===== */
    function speak(text, pitch = 1.3, rate = 0.95) {
      if (!('speechSynthesis' in window)) return;
      speechSynthesis.cancel();
      const u = new SpeechSynthesisUtterance(text);
      u.lang = 'ja-JP';
      u.pitch = pitch;
      u.rate = rate;
      speechSynthesis.speak(u);
    }

    const screenGreetings = {
      animals: '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ„Å©„ÅÜ„Å∂„Å§„Åß„ÅÇ„Åù„Åº„ÅÜÔºÅ„Åô„Åç„Å™„Å©„ÅÜ„Å∂„Å§„Çí„Çø„ÉÉ„Éó„Åó„Å¶„Å≠ÔºÅ',
      colors: '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ„ÅÑ„Çç„ÅÇ„Å¶„ÇØ„Ç§„Ç∫„Å†„ÇàÔºÅ„Åå„Çì„Å∞„Å£„Å¶„Å≠ÔºÅ',
      balloons: '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ„Åµ„ÅÜ„Åõ„Çì„Çí„Çø„ÉÉ„Éó„Åó„Å¶„Çè„Å£„Å¶„Å≠ÔºÅ',
      drawing: '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ„Åô„Åç„Å™„Åà„Çí„Åã„ÅÑ„Å¶„Å≠ÔºÅ',
    };

    function goScreen(name) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(name).classList.add('active');
      document.getElementById('backBtn').classList.toggle('show', name !== 'home');
      currentScreen = name;

      if (name === 'balloons') startBalloons();
      else stopBalloons();

      if (name === 'colors') startColorGame();
      if (name === 'drawing') initCanvas();

      if (screenGreetings[name]) {
        speak(screenGreetings[name]);
      }
    }

    function goHome() {
      goScreen('home');
      speak('„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ„Å™„Å´„Åó„Å¶„ÅÇ„Åù„Å∂Ôºü');
    }

    /* ===== „Å©„ÅÜ„Å∂„Å§ ===== */
    const animalData = [
      { emoji: 'üê∂', name: '„ÅÑ„Å¨', sound: '„ÉØ„É≥„ÉØ„É≥ÔºÅ' },
      { emoji: 'üê±', name: '„Å≠„Åì', sound: '„Éã„É£„ÉºÔºÅ' },
      { emoji: 'üê∑', name: '„Å∂„Åü', sound: '„Éñ„Éº„Éñ„ÉºÔºÅ' },
      { emoji: 'üêÆ', name: '„ÅÜ„Åó', sound: '„É¢„Éº„É¢„ÉºÔºÅ' },
      { emoji: 'üêî', name: '„Å´„Çè„Å®„Çä', sound: '„Ç≥„Ç±„Ç≥„ÉÉ„Ç≥„ÉºÔºÅ' },
      { emoji: 'üê∏', name: '„Åã„Åà„Çã', sound: '„Ç±„É≠„Ç±„É≠ÔºÅ' },
      { emoji: 'üêò', name: '„Åû„ÅÜ', sound: '„Éë„Ç™„Éº„É≥ÔºÅ' },
      { emoji: 'ü¶Å', name: '„Çâ„ÅÑ„Åä„Çì', sound: '„Ç¨„Ç™„ÉºÔºÅ' },
      { emoji: 'üê•', name: '„Å≤„Çà„Åì', sound: '„Éî„É®„Éî„É®ÔºÅ' },
    ];

    const animalGrid = document.getElementById('animalGrid');
    animalData.forEach(a => {
      const btn = document.createElement('button');
      btn.className = 'animal-btn';
      btn.innerHTML = `${a.emoji}<span class="animal-name">${a.name}</span>`;
      btn.onclick = () => showAnimal(a);
      animalGrid.appendChild(btn);
    });

    const animalMessages = [
      '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ{name}„Å†„ÇàÔºÅ{sound}',
      '{name}„Åï„Çì„Åå{sound}„Å£„Å¶„ÅÑ„Å£„Å¶„Çã„ÇàÔºÅ',
      '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÅØ{name}„Åô„ÅçÔºü{sound}',
      '{name}„Å†„Å≠ÔºÅ„ÅÑ„Å£„Åó„Çá„Å´{sound}',
    ];

    function showAnimal(a) {
      document.getElementById('popupEmoji').textContent = a.emoji;
      document.getElementById('popupSound').textContent = a.sound;
      const popup = document.getElementById('animalPopup');
      popup.classList.add('show');

      const msg = animalMessages[Math.floor(Math.random() * animalMessages.length)]
        .replace('{name}', a.name)
        .replace('{sound}', a.sound);
      speak(msg);

      setTimeout(() => popup.classList.remove('show'), 2200);
    }

    /* ===== „ÅÑ„Çç„ÅÇ„Åù„Å≥ ===== */
    const colorData = [
      { name: '„ÅÇ„Åã', color: '#ff4757', text: '#ff4757' },
      { name: '„ÅÇ„Åä', color: '#3498ff', text: '#3498ff' },
      { name: '„Åç„ÅÑ„Çç', color: '#ffd32a', text: '#d4a800' },
      { name: '„Åø„Å©„Çä', color: '#2ed573', text: '#2ed573' },
      { name: '„Ç™„É¨„É≥„Ç∏', color: '#ff9f43', text: '#ff9f43' },
      { name: '„ÇÄ„Çâ„Åï„Åç', color: '#a55eea', text: '#a55eea' },
    ];

    let colorAnswer = null;
    let colorStreak = 0;

    function startColorGame() {
      colorStreak = 0;
      nextColorQuestion();
    }

    function nextColorQuestion() {
      const target = colorData[Math.floor(Math.random() * colorData.length)];
      colorAnswer = target;

      const targetEl = document.getElementById('colorTarget');
      targetEl.textContent = target.name;
      targetEl.style.color = target.text;

      // „Ç∑„É£„ÉÉ„Éï„É´„Åó„Å¶Ë°®Á§∫
      const shuffled = [...colorData].sort(() => Math.random() - 0.5);
      const grid = document.getElementById('colorGrid');
      grid.innerHTML = '';
      shuffled.forEach(c => {
        const btn = document.createElement('button');
        btn.className = 'color-btn';
        btn.style.background = c.color;
        btn.onclick = (e) => checkColor(c, e);
        grid.appendChild(btn);
      });

      document.getElementById('colorResult').textContent = '';

      // ÂïèÈ°å„ÇíË™≠„Åø‰∏ä„ÅíÔºàÁîªÈù¢Âàá„ÇäÊõø„ÅàÊôÇ„ÅÆÊå®Êã∂„Å®Ë¢´„Çâ„Å™„ÅÑ„Çà„ÅÜÂ∞ë„ÅóÈÅÖÂª∂Ôºâ
      setTimeout(() => speak('„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ' + target.name + '„ÅØ„Å©„Çå„Åã„Å™Ôºü'), 800);
    }

    const correctMessages = [
      '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ„Åô„Åî„Éº„ÅÑÔºÅ„Åõ„ÅÑ„Åã„ÅÑÔºÅ',
      '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ„Å¶„Çì„Åï„ÅÑÔºÅ',
      '„ÇÑ„Å£„Åü„Å≠„ÄÅ„Åä„Å®„Åã„Å°„ÇÉ„ÇìÔºÅ„Åõ„ÅÑ„Åã„ÅÑ„Å†„ÇàÔºÅ',
      '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ„Åã„Å£„Åì„ÅÑ„ÅÑÔºÅ„Åõ„ÅÑ„Åã„ÅÑÔºÅ',
    ];

    const wrongMessages = [
      '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ„Åä„Åó„ÅÑÔºÅ„ÇÇ„ÅÜ„ÅÑ„Å£„Åã„ÅÑÔºÅ',
      '„ÇÇ„ÅÜ„ÅÑ„Å°„Å©„ÇÑ„Å£„Å¶„Åø„Çà„ÅÜÔºÅ„Åå„Çì„Å∞„Çå„ÄÅ„Åä„Å®„Åã„Å°„ÇÉ„ÇìÔºÅ',
      '„Å°„Åå„ÅÜ„ÇàÔΩû„ÄÅ„ÇÇ„ÅÜ„ÅÑ„Å£„Åã„ÅÑ„ÉÅ„É£„É¨„É≥„Ç∏ÔºÅ',
    ];

    function checkColor(c, e) {
      const resultEl = document.getElementById('colorResult');
      if (c.name === colorAnswer.name) {
        colorStreak++;
        resultEl.textContent = '‚≠ê „Åô„Åî„ÅÑÔºÅ„Åõ„ÅÑ„Åã„ÅÑÔºÅ ‚≠ê';
        spawnStars(e.clientX || e.touches?.[0]?.clientX || 200, e.clientY || e.touches?.[0]?.clientY || 300, 6);

        const msg = correctMessages[Math.floor(Math.random() * correctMessages.length)];
        speak(msg, 1.4);

        setTimeout(nextColorQuestion, 2000);
      } else {
        resultEl.textContent = '„ÇÇ„ÅÜ„ÅÑ„Å£„Åã„ÅÑÔºÅüí™';
        const msg = wrongMessages[Math.floor(Math.random() * wrongMessages.length)];
        speak(msg, 1.2);
      }
      document.getElementById('colorScore').textContent = '‚≠ê'.repeat(Math.min(colorStreak, 20));
    }

    /* ===== „Åµ„ÅÜ„Åõ„Çì„Ç≤„Éº„É† ===== */
    const balloonEmojis = ['üéà', 'ü©∑', 'üíõ', 'üíö', 'üíô', 'üíú', 'üß°', '‚≠ê', 'üåü', 'üéÄ'];
    let balloonScoreVal = 0;

    function startBalloons() {
      balloonScoreVal = 0;
      document.getElementById('balloonScore').textContent = '0';
      // Êó¢Â≠ò„ÅÆÈ¢®Ëàπ„ÇíÊ∂à„Åô
      document.querySelectorAll('.balloon').forEach(b => b.remove());
      balloonInterval = setInterval(spawnBalloon, 900);
    }

    function stopBalloons() {
      if (balloonInterval) { clearInterval(balloonInterval); balloonInterval = null; }
    }

    function spawnBalloon() {
      const balloon = document.createElement('div');
      balloon.className = 'balloon';
      balloon.textContent = balloonEmojis[Math.floor(Math.random() * balloonEmojis.length)];

      const x = 10 + Math.random() * 80;
      balloon.style.left = x + '%';
      balloon.style.bottom = '-60px';

      const dur = 4 + Math.random() * 3;
      balloon.style.animationDuration = dur + 's';

      balloon.onclick = (e) => popBalloon(balloon, e);
      balloon.ontouchstart = (e) => {
        e.preventDefault();
        const t = e.touches[0];
        popBalloon(balloon, { clientX: t.clientX, clientY: t.clientY });
      };

      document.getElementById('balloons').appendChild(balloon);

      // ÁîªÈù¢Â§ñ„Å´Âá∫„Åü„ÇâÊ∂à„Åô
      setTimeout(() => { if (balloon.parentNode) balloon.remove(); }, dur * 1000 + 100);
    }

    function popBalloon(balloon, e) {
      if (!balloon.parentNode) return;
      const x = e.clientX || 200;
      const y = e.clientY || 300;

      // „Éù„ÉÉ„Éó„Ç®„Éï„Çß„ÇØ„Éà
      const pop = document.createElement('div');
      pop.className = 'pop-effect';
      pop.textContent = '‚ú®';
      pop.style.left = (x - 16) + 'px';
      pop.style.top = (y - 16) + 'px';
      document.body.appendChild(pop);
      setTimeout(() => pop.remove(), 600);

      spawnStars(x, y, 4);
      balloon.remove();

      balloonScoreVal++;
      document.getElementById('balloonScore').textContent = balloonScoreVal;

      // ÁØÄÁõÆ„ÅßË§í„ÇÅ„Çã
      const balloonPraise = {
        5:  '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ5„Åì„ÇÇ„Çè„Å£„Åü„Å≠ÔºÅ„Åô„Åî„ÅÑÔºÅ',
        10: '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ10„ÅìÔºÅ„Å®„Å£„Å¶„ÇÇ„Åò„Çá„ÅÜ„ÅöÔºÅ',
        20: '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ20„ÅìÔºÅ„ÉÅ„É£„É≥„Éî„Ç™„É≥„Å†„Å≠ÔºÅ',
        30: '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ30„ÅìÔºÅ„Å†„Çå„Å´„ÇÇ„Åæ„Åë„Å™„ÅÑ„Å≠ÔºÅ',
        50: '„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ50„ÅìÔºÅ„Åô„Åî„Åô„Åé„Çã„ÉºÔºÅ',
      };
      if (balloonPraise[balloonScoreVal]) {
        speak(balloonPraise[balloonScoreVal], 1.4);
      }
    }

    /* ===== „Åä„Åà„Åã„Åç ===== */
    const drawColors = ['#333', '#ff4757', '#ff9f43', '#ffd32a', '#2ed573', '#3498ff', '#a55eea', '#ff6b9d'];
    let drawColor = '#ff6b9d';
    let isDrawing = false;
    let drawCtx = null;

    function initCanvas() {
      const canvas = document.getElementById('drawCanvas');
      const toolbar = document.getElementById('drawToolbar');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight - 70;
      drawCtx = canvas.getContext('2d');
      drawCtx.lineCap = 'round';
      drawCtx.lineJoin = 'round';
      drawCtx.lineWidth = 8;

      // „Ç´„É©„Éº„Éú„Çø„É≥
      toolbar.innerHTML = '';
      drawColors.forEach(c => {
        const btn = document.createElement('button');
        btn.className = 'draw-color' + (c === drawColor ? ' active' : '');
        btn.style.background = c;
        btn.onclick = () => {
          drawColor = c;
          toolbar.querySelectorAll('.draw-color').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
        };
        toolbar.appendChild(btn);
      });

      const clearBtn = document.createElement('button');
      clearBtn.className = 'draw-clear';
      clearBtn.textContent = '„Åë„Åô';
      clearBtn.onclick = () => {
        drawCtx.clearRect(0, 0, canvas.width, canvas.height);
      };
      toolbar.appendChild(clearBtn);

      // ÊèèÁîª„Ç§„Éô„É≥„Éà
      canvas.onmousedown = (e) => { isDrawing = true; drawCtx.beginPath(); drawCtx.moveTo(e.offsetX, e.offsetY); };
      canvas.onmousemove = (e) => { if (!isDrawing) return; drawCtx.strokeStyle = drawColor; drawCtx.lineTo(e.offsetX, e.offsetY); drawCtx.stroke(); };
      canvas.onmouseup = () => { isDrawing = false; };

      canvas.ontouchstart = (e) => {
        e.preventDefault();
        isDrawing = true;
        const t = e.touches[0];
        const r = canvas.getBoundingClientRect();
        drawCtx.beginPath();
        drawCtx.moveTo(t.clientX - r.left, t.clientY - r.top);
      };
      canvas.ontouchmove = (e) => {
        e.preventDefault();
        if (!isDrawing) return;
        const t = e.touches[0];
        const r = canvas.getBoundingClientRect();
        drawCtx.strokeStyle = drawColor;
        drawCtx.lineTo(t.clientX - r.left, t.clientY - r.top);
        drawCtx.stroke();
      };
      canvas.ontouchend = () => { isDrawing = false; };
    }

    /* ===== Ëµ∑ÂãïÊôÇ„ÅÆ„ÅÇ„ÅÑ„Åï„Å§ ===== */
    window.addEventListener('load', () => {
      setTimeout(() => speak('„Åä„Å®„Åã„Å°„ÇÉ„Çì„ÄÅ„Åì„Çì„Å´„Å°„ÅØÔºÅ„Åç„Çá„ÅÜ„ÅØ„Å™„Å´„Åó„Å¶„ÅÇ„Åù„Å∂Ôºü', 1.4, 0.9), 500);
    });

    /* ===== Êòü„Ç®„Éï„Çß„ÇØ„Éà ===== */
    function spawnStars(x, y, count) {
      const stars = ['‚≠ê', 'üåü', '‚ú®', 'üí´'];
      for (let i = 0; i < count; i++) {
        const star = document.createElement('div');
        star.className = 'star-burst';
        star.textContent = stars[Math.floor(Math.random() * stars.length)];
        star.style.left = (x + (Math.random() - 0.5) * 80) + 'px';
        star.style.top = (y + (Math.random() - 0.5) * 80) + 'px';
        document.body.appendChild(star);
        setTimeout(() => star.remove(), 800);
      }
    }
  </script>
</body>
</html>
